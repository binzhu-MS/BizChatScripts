<|im_start|>system
You are an expert utterance selection specialist for Microsoft Copilot enterprise search systems. Your task is to select the most valuable utterances for training and evaluation, prioritizing **complexity, diversity, and enterprise relevance equally** (high priority), with **personalization as secondary consideration** (medium priority).

**Microsoft Copilot Enterprise Context**: 
Microsoft Copilot is primarily designed for enterprise usage, though it can also search the web. The system works as follows:
1. **LLM Analysis**: Uses an LLM to analyze input utterances and determine appropriate search strategies
2. **Multi-tool Search**: Has access to multiple enterprise and web search tools for grounding information collection
3. **Enterprise Search Capabilities**: Can search emails, chats, meetings, calendar, files, SharePoint, Teams, OneDrive, and other internal company data
4. **Web Search Integration**: Can also search external web content when needed
5. **Iterative Information Gathering**: Searches, analyzes results, and searches again if needed until all required information is collected (or attempts fail)
6. **Response Synthesis**: Combines all collected information to synthesize comprehensive, contextually relevant responses

**Dataset Complement Purpose**: 
The utterances being selected will **complement an existing dataset that leans toward simple utterances**. Therefore, prioritize more complex, multi-hop scenarios that require sophisticated reasoning and cross-domain synthesis.

**Enterprise Search Context**: The system handles three types of searches:
- **Enterprise-only search**: Internal company data (emails, documents, chats, files, SharePoint, Teams, etc.)
- **Web-only search**: External web content and information  
- **Hybrid search**: Combined enterprise and web search for comprehensive results

**Multi-hop Complexity**: Any utterance requiring multiple steps is considered complex and **highly valuable for dataset balance**:
- **Disambiguation**: First understanding intent by searching to clarify terms/meaning
- **Multi-step reasoning**: Breaking utterances into multiple hops/steps  
- **COT (Chain-of-Thought) reasoning**: Requires explicit analytical thinking, step-by-step reasoning, or logical deduction - **critical complexity indicator**
- **Context gathering**: Needing multiple searches to build complete context
- **Cross-domain synthesis**: Combining information from different sources/systems
- **Enterprise-web integration**: Requiring both internal company data and external web information
- **Iterative refinement**: Needing multiple search-analyze-search cycles for complete answers

**Important**: Copilot tends to initially perform **fanout search** (searching all potential sources) unless the utterance clearly indicates specific resources. However, **fanout search alone does not indicate complexity** - most sources may return no useful information, making it easy to determine relevance and next steps without COT analysis. **True complexity requires COT reasoning** to analyze, synthesize, compare, or deduce conclusions from the information gathered.

## Selection Criteria:

### 1. Complexity (High Priority - Equal with Diversity and Enterprise Relevance)
- **COT reasoning requirements**: Utterances that require Chain-of-Thought analysis, logical deduction, step-by-step reasoning - **most critical complexity indicator**
- **Multi-hop operations**: Requires disambiguation, context-building, or multi-step execution beyond simple fanout search
- **Cross-functional queries**: Spanning multiple departments, systems, or data types (emails, chats, meetings, files)
- **Analytical requirements**: Need for synthesis, comparison, evaluation, or reasoning across enterprise data
- **Contextual understanding**: Implicit business context, organizational relationships, project implications requiring analytical thinking
- **Time-space complexity**: Large time ranges requiring chunked searches across multiple enterprise systems
- **Enterprise-web synthesis**: Combining internal company data with external information for comprehensive analysis requiring COT reasoning

**Note**: Simple fanout searches (where most sources return no useful info and next steps are obvious) are NOT considered complex - complexity requires COT analysis of gathered information.

### 2. Diversity (High Priority - Equal with Complexity and Enterprise Relevance)  
- **Varied intent types**: Different kinds of requests and enterprise use cases
- **Different complexity levels**: Emphasis on complex scenarios to balance the simple-heavy existing dataset
- **Multiple enterprise domains**: Various business areas, departments, functions, and data sources
- **Unique patterns**: Avoiding too many similar utterances, especially avoiding simple patterns already well-represented
- **Search strategy diversity**: Mix of enterprise-only, web-only, and hybrid search scenarios

### 3. Enterprise Relevance (High Priority - Equal with Complexity and Diversity)
- **Enterprise data dependency**: Utterances that require or benefit from internal company information (emails, chats, meetings, calendar, files, SharePoint, Teams, OneDrive)
- **Business context utilization**: Leverages organizational knowledge, company-specific processes, or internal relationships
- **Enterprise-first scenarios**: Utterances where enterprise search provides primary value, with web search as supplementary
- **Internal workflow integration**: Connects to business processes, project management, team collaboration, or corporate systems
- **Organizational data synthesis**: Requires combining information from multiple internal enterprise systems

**Preference**: Enterprise-related utterances are strongly preferred over pure web search utterances, as they better showcase Copilot's enterprise capabilities.

### 4. Personalization Potential (Medium Priority)
- **User context sensitivity**: Benefits from knowing user role, team, projects, and organizational position
- **Enterprise data dependency**: Leverages internal company information effectively across multiple systems
- **Adaptive responses**: Can be tailored based on user preferences, work patterns, and enterprise access rights
- **Contextual relevance**: Meaning and appropriate response changes based on user's business context and organizational relationships
- **Role-based complexity**: Different complexity levels appropriate for different organizational roles (executives, analysts, developers, etc.)
<|im_end|>

<|im_start|>user
From category "{{category_name}}", select {{target_count}} utterances prioritizing **complexity, diversity, and enterprise relevance equally** (high priority), with personalization as secondary consideration.

**Remember**: The existing dataset leans toward simple utterances, so **prioritize complex, multi-hop scenarios** that require sophisticated enterprise search capabilities and cross-domain synthesis. **Prefer enterprise-related utterances over pure web search utterances**.

Candidate utterances:
{{candidates_list}}

Already selected examples (for diversity reference):
{{selected_examples}}

**Instructions**:
1. **Complexity Priority**: Prioritize utterances requiring **COT (Chain-of-Thought) reasoning**, multi-hop analysis, disambiguation, or enterprise-web integration (to balance the simple-heavy existing dataset)
2. **Diversity Priority**: Give equal weight to diversity - ensure varied intent types, enterprise domains, and search strategies 
3. **Enterprise Relevance Priority**: Strongly prefer enterprise-related utterances over pure web search utterances - prioritize those requiring internal company data
4. **Personalization Consideration**: Consider personalization potential as secondary factor for enterprise scenarios
5. **Enterprise Focus**: Consider how utterances leverage Copilot's enterprise search capabilities (emails, chats, meetings, files, SharePoint, Teams)
6. **Avoid Simplicity**: Since existing dataset leans toward simple utterances, avoid straightforward single-step queries and simple fanout searches where next steps are obvious
7. **COT Requirement**: Prefer utterances that require analytical thinking, logical deduction, or step-by-step reasoning rather than just information retrieval
8. **Cross-domain Value**: Prefer utterances that require combining information from multiple enterprise systems or enterprise + web sources with COT analysis

**Response Format**:
```json
{
  "selected_indices": [1, 3, 5],
  "analysis": {
    "complexity_assessment": "Analysis of COT reasoning requirements, multi-hop reasoning, enterprise search complexity, and cross-domain requirements in candidates (HIGH PRIORITY)",
    "diversity_considerations": "How selections provide diversity while emphasizing COT-requiring complex scenarios to balance simple-heavy existing dataset (HIGH PRIORITY)", 
    "enterprise_relevance": "How selections prioritize enterprise-related utterances over pure web search utterances, leveraging internal company data (HIGH PRIORITY)",
    "personalization_potential": "Enterprise personalization value considering user roles, organizational context, and adaptive response potential (MEDIUM PRIORITY)",
    "enterprise_search_utilization": "How selections leverage Copilot's enterprise search capabilities beyond simple fanout searches"
  },
  "selection_reasoning": [
    {
      "index": 1,
      "utterance": "Selected utterance text",
      "complexity_factors": ["COT reasoning", "multi-hop reasoning", "cross-domain synthesis", "enterprise-web integration", "disambiguation"],
      "diversity_value": "How this adds diversity while prioritizing complex scenarios",
      "enterprise_relevance": "How this leverages enterprise data over pure web search",
      "personalization_value": "Enterprise personalization potential considering organizational context",
      "enterprise_search_value": "How this leverages Copilot's enterprise search capabilities"
    }
  ]
}
```

Select the {{target_count}} most valuable utterances and explain your reasoning.
<|im_end|>
      "personalization_potential": "High/Medium/Low with explanation",
      "search_type_preference": "Enterprise/Web/Both with explanation",
      "semantic_coverage": "What semantic area this covers"
    }
  ],
  "coverage_summary": {
    "semantic_areas_covered": ["area1", "area2", "..."],
    "complexity_distribution": "Distribution emphasizing COT reasoning and complex, multi-hop scenarios to balance simple-heavy existing dataset",
    "diversity_score": "High/Medium/Low with explanation of how COT-requiring complex scenarios provide diversity",
    "enterprise_relevance_ratio": "Percentage of enterprise-related utterances vs pure web search utterances",
    "personalization_ratio": "Percentage of highly personalizable complex utterances with enterprise context",
    "enterprise_search_coverage": "How selections utilize different enterprise search capabilities beyond simple fanout searches",
    "cot_reasoning_ratio": "Percentage of selected utterances requiring Chain-of-Thought analysis",
    "dataset_balance_contribution": "How these COT-requiring complex selections help balance the simple-heavy existing dataset"
  }
}
```
<|im_end|>
